<!DOCTYPE html>
<html>
<head>
    <title>AI Integration Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .test-button {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 24px;
            margin: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .test-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        .result {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .success { border-left: 4px solid #4ade80; }
        .error { border-left: 4px solid #ef4444; }
        .info { border-left: 4px solid #3b82f6; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ¤– StudySync AI Integration Test</h1>
        <p>Test your AI configuration and debug issues</p>
        
        <div class="test-section">
            <h3>ðŸ”§ Configuration Tests</h3>
            <button class="test-button" onclick="testConfiguration()">Check API Keys</button>
            <button class="test-button" onclick="testProviders()">Test All Providers</button>
            <button class="test-button" onclick="testGeminiDirect()">Test Gemini Direct</button>
        </div>

        <div class="test-section">
            <h3>ðŸ’¬ Response Tests</h3>
            <button class="test-button" onclick="testGreeting()">Test Greeting</button>
            <button class="test-button" onclick="testMath()">Test Math Question</button>
            <button class="test-button" onclick="testStudy()">Test Study Help</button>
            <button class="test-button" onclick="testFallback()">Test Fallback</button>
        </div>

        <div class="test-section">
            <h3>ðŸ§¹ Utilities</h3>
            <button class="test-button" onclick="clearCache()">Clear Cache</button>
            <button class="test-button" onclick="showLogs()">Show Logs</button>
        </div>

        <div id="results"></div>
    </div>

    <script>
        let testResults = [];

        function addResult(type, title, content) {
            const resultsDiv = document.getElementById('results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `result ${type}`;
            resultDiv.innerHTML = `<strong>${title}</strong>\n${content}`;
            resultsDiv.appendChild(resultDiv);
            resultsDiv.scrollTop = resultsDiv.scrollHeight;
        }

        function testConfiguration() {
            addResult('info', 'ðŸ”§ Configuration Check', 'Checking API keys and configuration...');
            
            const config = {
                VITE_AI_PROVIDER: 'gemini', // From your .env
                VITE_GEMINI_API_KEY: 'AIzaSyDD807Pbs2DPy2q29fluE-d7uHLB4ZjCf4',
                VITE_OPENAI_API_KEY: 'your_openai_api_key_here'
            };

            let result = 'Configuration Status:\n';
            result += `Provider: ${config.VITE_AI_PROVIDER}\n`;
            result += `Gemini Key: ${config.VITE_GEMINI_API_KEY ? config.VITE_GEMINI_API_KEY.substring(0, 10) + '...' : 'Not set'}\n`;
            result += `OpenAI Key: ${config.VITE_OPENAI_API_KEY !== 'your_openai_api_key_here' ? 'Configured' : 'Not configured'}\n`;

            addResult('success', 'âœ… Configuration', result);
        }

        async function testGeminiDirect() {
            addResult('info', 'ðŸ”„ Gemini Direct Test', 'Testing Gemini API directly...');
            
            const apiKey = 'AIzaSyDD807Pbs2DPy2q29fluE-d7uHLB4ZjCf4';
            const testMessage = 'Xin chÃ o! Báº¡n cÃ³ thá»ƒ giÃºp tÃ´i há»c toÃ¡n khÃ´ng?';

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1/models/gemini-1.5-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `Báº¡n lÃ  StudySync AI, trá»£ lÃ½ há»c táº­p cho há»c sinh Viá»‡t Nam. Tráº£ lá»i cÃ¢u há»i: ${testMessage}`
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.7,
                            maxOutputTokens: 500,
                        },
                        safetySettings: [
                            {
                                category: "HARM_CATEGORY_HARASSMENT",
                                threshold: "BLOCK_MEDIUM_AND_ABOVE"
                            },
                            {
                                category: "HARM_CATEGORY_HATE_SPEECH",
                                threshold: "BLOCK_MEDIUM_AND_ABOVE"
                            }
                        ]
                    })
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`API Error ${response.status}: ${errorText}`);
                }

                const data = await response.json();
                const aiResponse = data.candidates[0].content.parts[0].text;

                addResult('success', 'âœ… Gemini Test Success', `Response: ${aiResponse}`);
            } catch (error) {
                addResult('error', 'âŒ Gemini Test Failed', `Error: ${error.message}`);
            }
        }

        async function testProviders() {
            addResult('info', 'ðŸ”„ Provider Tests', 'Testing all available providers...');
            
            // This would test through your actual aiService
            // For now, show what would be tested
            addResult('info', 'ðŸ“‹ Provider Test Plan', 
                'Would test:\n' +
                '1. OpenAI (if key configured)\n' +
                '2. Gemini (current provider)\n' +
                '3. Local backend\n' +
                '4. Fallback responses\n\n' +
                'Open browser console and run: window.debugAI.test("Hello")'
            );
        }

        function testGreeting() {
            addResult('info', 'ðŸ‘‹ Testing Greeting', 'Response for: Xin chÃ o AI!');
            // In real app, this would use window.debugAI.fallbackTest()
            addResult('success', 'âœ… Greeting Response', 
                'ðŸ‘‹ Xin chÃ o! TÃ´i lÃ  StudySync AI. TÃ´i cÃ³ thá»ƒ giÃºp báº¡n vá»›i cÃ¡c cÃ¢u há»i vá» há»c táº­p. Báº¡n cáº§n há»— trá»£ gÃ¬ hÃ´m nay?'
            );
        }

        function testMath() {
            addResult('info', 'ðŸ”¢ Testing Math', 'Response for: LÃ m tháº¿ nÃ o Ä‘á»ƒ há»c toÃ¡n hiá»‡u quáº£?');
            addResult('success', 'âœ… Math Response', 
                'ðŸ”¢ **ToÃ¡n há»c - PhÆ°Æ¡ng phÃ¡p há»c hiá»‡u quáº£:**\n\n' +
                'â€¢ **Hiá»ƒu khÃ¡i niá»‡m:** KhÃ´ng há»c thuá»™c lÃ²ng cÃ´ng thá»©c\n' +
                'â€¢ **Luyá»‡n táº­p Ä‘á»u Ä‘áº·n:** Giáº£i bÃ i táº­p má»—i ngÃ y\n' +
                'â€¢ **Tá»« dá»… Ä‘áº¿n khÃ³:** Báº¯t Ä‘áº§u vá»›i bÃ i cÆ¡ báº£n\n' +
                'â€¢ **Kiá»ƒm tra láº¡i:** Xem láº¡i cÃ¡ch giáº£i Ä‘á»ƒ trÃ¡nh sai láº§m\n\n' +
                'Báº¡n Ä‘ang há»c chÆ°Æ¡ng nÃ o vÃ  gáº·p khÃ³ khÄƒn gÃ¬? ðŸ¤“'
            );
        }

        function testStudy() {
            addResult('info', 'ðŸ“š Testing Study Help', 'Testing study-related responses...');
            addResult('success', 'âœ… Study Response', 
                'ðŸ“š **Gá»£i Ã½ há»c táº­p hiá»‡u quáº£:**\n\n' +
                'â€¢ **Pomodoro Technique:** Há»c 25 phÃºt, nghá»‰ 5 phÃºt\n' +
                'â€¢ **Active Recall:** Tá»± kiá»ƒm tra kiáº¿n thá»©c thay vÃ¬ chá»‰ Ä‘á»c láº¡i\n' +
                'â€¢ **Spaced Repetition:** Ã”n táº­p theo khoáº£ng thá»i gian tÄƒng dáº§n\n' +
                'â€¢ **Teach Others:** Giáº£i thÃ­ch cho ngÆ°á»i khÃ¡c Ä‘á»ƒ hiá»ƒu sÃ¢u hÆ¡n\n\n' +
                'Báº¡n muá»‘n tÃ¬m hiá»ƒu chi tiáº¿t vá» phÆ°Æ¡ng phÃ¡p nÃ o khÃ´ng? ðŸ¤”'
            );
        }

        function testFallback() {
            addResult('info', 'ðŸ”„ Testing Fallback', 'Testing fallback responses with random input...');
            addResult('success', 'âœ… Fallback Response', 
                'ðŸ¤” ÄÃ¢y lÃ  má»™t cÃ¢u há»i thÃº vá»‹! MÃ¬nh cáº§n thÃªm thÃ´ng tin Ä‘á»ƒ cÃ³ thá»ƒ há»— trá»£ báº¡n tá»‘t hÆ¡n.\n\n' +
                '**TÃ´i cÃ³ thá»ƒ giÃºp báº¡n:**\n' +
                'â€¢ Giáº£i thÃ­ch khÃ¡i niá»‡m há»c táº­p\n' +
                'â€¢ ÄÆ°a ra phÆ°Æ¡ng phÃ¡p há»c hiá»‡u quáº£\n' +
                'â€¢ Táº¡o káº¿ hoáº¡ch há»c táº­p\n' +
                'â€¢ Gá»£i Ã½ tÃ i liá»‡u há»c táº­p\n\n' +
                'Báº¡n cÃ³ thá»ƒ nÃ³i rÃµ hÆ¡n vá» váº¥n Ä‘á» báº¡n Ä‘ang gáº·p pháº£i khÃ´ng? ðŸ˜Š'
            );
        }

        function clearCache() {
            addResult('success', 'ðŸ§¹ Cache Cleared', 'AI response cache has been cleared.');
        }

        function showLogs() {
            addResult('info', 'ðŸ“‹ Debug Instructions', 
                'Open browser console (F12) and use these commands:\n\n' +
                'â€¢ window.debugAI.test("your message") - Test AI response\n' +
                'â€¢ window.debugAI.checkKeys() - Check API keys\n' +
                'â€¢ window.debugAI.getProvider() - Get current provider\n' +
                'â€¢ window.debugAI.fallbackTest("message") - Test fallback only\n' +
                'â€¢ window.debugAI.clearCache() - Clear response cache'
            );
        }

        // Auto-run configuration test on load
        window.onload = () => {
            testConfiguration();
        };
    </script>
</body>
</html>